<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
<title>商品详情</title>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/121/css/swiper.min.css"/>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/121/css/common.css"/>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/121/css/style.css"/>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/121/css/buy_box.css"/>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/121/css/weui.css"/>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/121/css/weui_reset.css"/>
<style>
.bottom-btn{position: fixed;left: 0;right: 0;bottom: 0;max-width: 640px;width: 100%;text-align: center;
height: 46px;line-height: 46px;margin: auto;background: #FE8425;color: #fff;background: #FE9422;font-size: .3rem;}
.swiper-pagination-bullet-active{background:#FE9422;}
.details{background: #fff;padding: .2rem;}
.details .goods_name{font-size: .3rem;color: #111;}
.details .goods_price{font-size: .3rem;color: #FF951D;margin: .1rem 0;}
.details .goods_price del{color: #666;font-size: .2rem;margin-left: .5rem;}
.img-block{width: 100%;display: block;}
.text{height: 40px;line-height: 40px;background: #fff;margin: 10px 0;padding-left: 10px;text-align: center;}
.spec span{padding:.15rem .2rem;margin-right: .2rem;border: 1px #666 solid;display: inline-block;color: #666;border-radius: 4px;}
.spec .option_active{color: #fff;background: #FE9422;border: 1px #FE9422 solid;}

._icon {display: inline-block;vertical-align: middle;
    width: 40px;
    height: 40px;
    background: url(__PUBLIC__/121/img/icons.png) center 0px no-repeat;
    background-size: 40px auto;
}
.icon_trans_ps {background-position: center -360px;}
.details-texts{background: #fff;line-height: 1.6;letter-spacing: 1px;text-indent: 24px;padding: .2rem;}
#logo{display: inline-block;vertical-align: middle;
	margin-right: 6px;
	background: url(__PUBLIC__/121/img/logo.jpg) no-repeat 0 0;
	width: 48px;
	height: 48px;
	background-size: 48px 48px;
}
.weui-cell_access:active{background: #fff}
.dispatch{background: #fff;padding: .1rem;margin-top: 10px;}
.dispatch span{vertical-align: middle;}
.weui-panel__ft{background: #fff;margin-top: 10px;}
.weui-cell{color: #000;border-bottom: 0;}
.details-texts img{display:block;width:100%;}
</style>
</head>
<body style="background:#f8f8f8;">
	<div class="app_container">
		<header>
			<div class="fixed header_inner">
				<div class="head">				
					<span class="left_arrow" onclick="javascript:history.go(-1)"><img src="__PUBLIC__/121/img/left-white.png"/></span>
					<span>商品详情</span>	
					<!--<span class="r-icon"><img src="user-__PUBLIC__/121/img/gwc_top.png"/></span>-->
					<div class="clear"></div>					
				</div>
			</div>
		</header>
		<!--商品轮播图-->
		<div id="banner">
			<div class="swiper-wrapper">
			    <volist name="pic" id="vv">
				<if condition="$vv['pic_url']">
			    <div class="swiper-slide"><img src="{$vv['pic_url']}"/></div>
				</if>
				</volist>
			</div>
			<div class="pagination"></div>  
		</div>
		<div class="details">
			<p class="goods_name">{$data.good_name}</p>
			<if condition="$data.good_id eq 1">
				<span class="goods_price">价格：¥{$data.good_chengben}/两瓶</span>
				<elseif condition="$data.good_id eq 2"/>
				<span class="goods_price">价格：¥{$data.good_chengben}/两瓶</span>
				<elseif condition="$data.good_id eq 3"/>
				<span class="goods_price">价格：¥{$data.good_chengben}/箱</span>
			</if>
		</div>
		<div class="dispatch">
			<i class="_icon icon_trans_ps"></i>
			<span>商家配送</span>
		</div>
		<div class="weui-panel__ft">
			<div  onclick="show()" class="weui-cell weui-cell_access  weui-cell_link">
			    <div class="weui-cell__bd">请选择规格</div> 	
			    <span class="weui-cell__ft"></span>
			</div>    
		</div>
		
		<div class="weui-panel__ft">
			<div class="weui-cell  weui-cell_link">
				<div id="logo"></div>
			    <div class="weui-cell__bd">
			    	<div style="font-size:.3rem;">知酒堂</div>
			    	<div style="color: #24bf24;font-size:.25rem;">微信认证</div>
			    </div> 	
			    <span class="weui-cell__ft"></span>
			</div>    
		</div>
		<!--图文详情-->
		<div   style="padding-bottom:60px;">
			<div class="text">图文详情</div>
			<div class="details-texts">
				{$data.good_desc}
			</div>
			<!--<img class="img-block" src="__PUBLIC__/121/img/banner.png"/>-->
			<!--<img class="img-block" src="__PUBLIC__/121/img/img1.png"/>-->
		</div>
      	<div class="bottom-btn" onclick="show()">立即购买</div>
    
		<!--立即购买-->
		<div class="mask"></div>
	  	<div class="buy_box">
		    <div class="inner">
		      	<div class="goods">
		        	<img class="goods_img" src="{$pic[0]['pic_url']}"/>
		        	<div class="goods_infor">
		          	<div class="goods_name">{$data.good_name}</div>
		          	<div class="bottom_infor">
						<if condition="$data.good_id eq 1">
							<span class="goods_price">价格：¥{$data.good_chengben}/两瓶</span>
							<elseif condition="$data.good_id eq 2"/>
							<span class="goods_price">价格：¥{$data.good_chengben}/两瓶</span>
							<elseif condition="$data.good_id eq 3"/>
							<span class="goods_price">价格：¥{$data.good_chengben}/箱</span>
						</if>
		          	</div>
		        	</div>
		        	<div onclick="cancel()">
		          	<img class="close_img" src="__PUBLIC__/121/img/icon_del.png"/>
		        	</div>
		      	</div>
				<div class="number" >
					<div class="tit">数量 : </div>
					<div class="num_wrap">
						<span class="minus" id="min"></span>
						<input class="num" id="quantity" name="" type="text" value="1" disabled/>
						<span class="plus" id="add"></span>
					</div>
					<div class="clear"></div>
				</div>
					
		    </div>
		    
		    <div class="gotobuy" onclick="setShop(2,{$data.good_id})" style="padding:.2rem;">立即购买</div>
	  	</div>
	</div>
</body>
<script src="__PUBLIC__/121/js/font.js" type="text/javascript" charset="utf-8"></script>
<script src="__PUBLIC__/121/js/jquery-1.10.1.min.js" type="text/javascript" charset="utf-8"></script>
<script src="__PUBLIC__/121/js/swiper.min.js" type="text/javascript" charset="utf-8"></script>
<script src="__PUBLIC__/admin/layer/layer.js"></script>
<script src="http://cdn.bootcss.com/blueimp-md5/1.1.0/js/md5.js"></script>
<script>


/*--------------------------------------*/
/*--------------------------------------*/
/*商品轮播图*/
	var mySwiper1 = new Swiper('#banner',{
	  autoplay:3000,
	  visibilityFullFit : true,
	  loop:true,
	  pagination : '.pagination',
  });
  
/*****************************************/


/*--------------------------------------*/
/*--------------------------------------*/
/*立即购买*/
  	function show(){
		$(".buy_box").addClass('box_toggle');
		$(".mask").fadeIn(200);
	}
function cancel(){
    $(".buy_box").removeClass('box_toggle');
    $(".mask").fadeOut(200);
}
/*--------------------------------------*/
/*--------------------------------------*/
/*加减数量*/
	$(function(){
		//获得文本框对象
		var t = $("#quantity");	
		//数量增加操作
		$("#add").click(function(){		
			t.val(parseInt(t.val())+1)
			if (parseInt(t.val())!=1){
				$('#min').attr('disabled',false);
			}
		})	
		//数量减少操作
		$("#min").click(function(){
			if (parseInt(t.val())>1) {    //判断数量值大于1时才可以减少  
		        t.val(parseInt(t.val())-1)  
		        }
			else{
		        $("#min").attr("disabled","disabled")//当$("#min")为1时，$("#min")不可读状态  
		        }  
		})	
	})	
</script>
<script>
    function setShop(type,good_id) {
        str = '';
        number = $("#quantity").val();
//		alert(number);
        $.ajax({
            type:"post",
            url:"{:U('Cart/Ljjiesuan')}",
            dataType:"json",
            data:{
                good_id:good_id,
                type:str,
                number:number
            },
            success:function (data) {
                if(data == -2){
                    layer.msg('请购买代理');
                }
                if(data > 0){
                    location.href = "{:U('Cart/order')}?order_id=" + data + "&agent_id={$Think.get.agent_id}";
                }
                if(data == -4){
                    layer.msg('该商品已经卖光，请选择其它商品');
                }
                if(data == -17){
                    layer.alert('你当天已达最高购买数量，请明天再买', {
                        skin: 'layui-layer-lan'
                        ,closeBtn: 0
                        ,anim: 4 //动画类型
                    });
                }
            }
        });
    }
</script>
</html>
